#!/bin/zsh

set -k

HOSTNAME="dashie"
NEWUSERNAME=zidar
USERPASS=pass
ROOTPASS=pass


function install_yaourt {
    local aa=$(pwd)
    pacman -Syy --noconfirm wget yajl

    cd /tmp

    wget https://aur.archlinux.org/cgit/aur.git/snapshot/package-query.tar.gz
    tar -xpvf package-query.tar.gz
    chmod 777 package-query
    cd package-query
    sudo -u nobody makepkg --noconfirm
    pacman --noconfirm -U package-query*.xz

    
    cd /tmp

    wget https://aur.archlinux.org/cgit/aur.git/snapshot/yaourt.tar.gz
    tar -xpvf yaourt.tar.gz
    chmod 777 yaourt
    cd yaourt
    sudo -u nobody makepkg --noconfirm
    pacman --noconfirm -U yaourt*-any.pkg.tar.xz

    cd $aa
}


install_yaourt

hostname $HOSTNAME
echo ${HOSTNAME} > /etc/hostname



sed -i 's/#sl_SI.UTF-8/sl_SI.UTF-8/' /etc/locale.gen
sed -i 's/#en_US.UTF-8/en_US.UTF-8/' /etc/locale.gen
sed -i 's/#en_GB.UTF-8/en_GB.UTF-8/' /etc/locale.gen
locale-gen




echo LANG=en_US.UTF-8 > /etc/locale.conf
export LANG=en_US.UTF-8

echo KEYMAP=us > /etc/vconsole.conf
sed -i '$ a FONT=' /etc/vconsole.conf
sed -i '$ a FONT_MAP=' /etc/vconsole.conf




pacman -S --noconfirm ntp 
ln -s /usr/share/zoneinfo/Europe/Ljubljana /etc/localtime
ntpd -qg
hwclock --systohc --utc



sed -i "s/\#\[multilib\]/\[multilib\]\nInclude = \/etc\/pacman\.d\/mirrorlist/g" /etc/pacman.conf 



pacman -Syy
pacman -S --noconfirm bash-completion vim sudo git openssh dosfstools wget htop
sed -i 's/# %wheel ALL=(ALL) ALL/%wheel ALL=(ALL) ALL/' /etc/sudoers


mkinitcpio -p linux
pacman -S --noconfirm grub-bios
grub-install --recheck /dev/sda
mkdir -p /boot/grub/locale
cp /usr/share/locale/en\@quot/LC_MESSAGES/grub.mo /boot/grub/locale/en.mo
grub-mkconfig -o /boot/grub/grub.cfg





useradd -m -g users -G wheel,storage,power -s /bin/bash $NEWUSERNAME
echo "$NEWUSERNAME\n\n\n\n" | chfn $NEWUSERNAME

echo "${USERPASS}\n${USERPASS}" | passwd $NEWUSERNAME
echo "${ROOTPASS}\n${ROOTPASS}" | passwd root

systemctl enable sshd.service







pacman -S --noconfirm alsa-utils
pacman -S --noconfirm xorg-server xorg-xinit xorg-server-utils
pacman -S --noconfirm xf86-video-intel 
pacman -S --noconfirm xf86-input-synaptics






pacman -S --noconfirm gnome gnome-extra 
pacman -S --noconfirm ttf-ubuntu-font-family ttf-liberation ttf-inconsolata ttf-droid ttf-linux-libertine ttf-dejavu ttf-bitstream-vera

systemctl enable gdm.service

pacman -S --noconfirm  networkmanager network-manager-applet
systemctl enable NetworkManager.service 



pacman -S --noconfirm  terminator blender gimp meld gitg smartmontools firefox rsync vlc pidgin deluge

pacman -R --noconfirm epiphany empathy gnome-chess gnome-mines gnome-sudoku gnome-tetravex gnome-robots gnome-klotski gnome-nibbles totem gnome-documents gnome-photos tracker evolution gnome-music gnome-online-miners bijiben


